<?xml version="1.0" encoding="utf-8" ?>
<!--
========================================================================
   Copyright (c) 2018-2019 Qualcomm Technologies, Inc.
   All Rights Reserved.
   Confidential and Proprietary - Qualcomm Technologies, Inc.
========================================================================
-->
<chromatixPDAF
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="..\..\..\xsd\stats\af\afpdafelements.xsd">

  <module_version major_revision="9" minor_revision="0" incr_revision="0"/>
  <parameter_version>
    <revision>"A"</revision>
  </parameter_version>

  <is2PDEnable description="Enable PDAF specific to dual-photodiode type image sensor">false</is2PDEnable>
  <ROI>
    <Configuration>
      <ROILocationY description="Y-coordinate for top-left corner of ROI in grid-based stats" range="[0,5]">0</ROILocationY>
      <ROILocationX description="X-coordinate for top-left corner of ROI in grid-based stats" range="[0,5]">0</ROILocationX>
      <ROINumRows description="Height of ROI in number of rows in grid-based stats" range="[1,5]">1</ROINumRows>
      <ROINumCols description="Width of ROI in number of columns in grid-based stats" range="[1,5]">4</ROINumCols>
    </Configuration>
    <Configuration>
      <ROILocationY description="Y-coordinate for top-left corner of ROI in grid-based stats" range="[0,5]">0</ROILocationY>
      <ROILocationX description="X-coordinate for top-left corner of ROI in grid-based stats" range="[0,5]">4</ROILocationX>
      <ROINumRows description="Height of ROI in number of rows in grid-based stats" range="[1,5]">1</ROINumRows>
      <ROINumCols description="Width of ROI in number of columns in grid-based stats" range="[1,5]">1</ROINumCols>
    </Configuration>
    <Configuration>
      <ROILocationY description="Y-coordinate for top-left corner of ROI in grid-based stats" range="[0,5]">0</ROILocationY>
      <ROILocationX description="X-coordinate for top-left corner of ROI in grid-based stats" range="[0,5]">5</ROILocationX>
      <ROINumRows description="Height of ROI in number of rows in grid-based stats" range="[1,5]">1</ROINumRows>
      <ROINumCols description="Width of ROI in number of columns in grid-based stats" range="[1,5]">1</ROINumCols>
    </Configuration>
  </ROI>
  <focusTable>
    <focusEntries>
      <defocus description="Defocus in logical lens position unit" range="[0,500]">32</defocus>
      <movePercent description="Percentage lens movement to target lens position" range="[0,1]">1</movePercent>
    </focusEntries>
    <focusEntries>
      <defocus description="Defocus in logical lens position unit" range="[0,500]">32</defocus>
      <movePercent description="Percentage lens movement to target lens position" range="[0,1]">0.8</movePercent>
    </focusEntries>
    <focusEntries>
      <defocus description="Defocus in logical lens position unit" range="[0,500]">96</defocus>
      <movePercent description="Percentage lens movement to target lens position" range="[0,1]">0.5</movePercent>
    </focusEntries>
    <focusEntries>
      <defocus description="Defocus in logical lens position unit" range="[0,500]">128</defocus>
      <movePercent description="Percentage lens movement to target lens position" range="[0,1]">0.6</movePercent>
    </focusEntries>
    <focusEntries>
      <defocus description="Defocus in logical lens position unit" range="[0,500]">352</defocus>
      <movePercent description="Percentage lens movement to target lens position" range="[0,1]">0.45</movePercent>
    </focusEntries>
  </focusTable>
  <noiseTable>
    <noiseEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">0</noiseGain>
      <noiseGainMultiplier description="Scaler by which size of rms noise increases. Scaler value of 1 implies rms noise is identical to the case where sensor gain is 1X" range="[1,10]">1</noiseGainMultiplier>
    </noiseEntries>
    <noiseEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">10</noiseGain>
      <noiseGainMultiplier description="Scaler by which size of rms noise increases. Scaler value of 1 implies rms noise is identical to the case where sensor gain is 1X" range="[1,10]">1.1</noiseGainMultiplier>
    </noiseEntries>
    <noiseEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">15</noiseGain>
      <noiseGainMultiplier description="Scaler by which size of rms noise increases. Scaler value of 1 implies rms noise is identical to the case where sensor gain is 1X" range="[1,10]">1.2</noiseGainMultiplier>
    </noiseEntries>
    <noiseEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">20</noiseGain>
      <noiseGainMultiplier description="Scaler by which size of rms noise increases. Scaler value of 1 implies rms noise is identical to the case where sensor gain is 1X" range="[1,10]">1.4</noiseGainMultiplier>
    </noiseEntries>
    <noiseEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">30</noiseGain>
      <noiseGainMultiplier description="Scaler by which size of rms noise increases. Scaler value of 1 implies rms noise is identical to the case where sensor gain is 1X" range="[1,10]">1.5</noiseGainMultiplier>
    </noiseEntries>
  </noiseTable>
  <confidenceTable>
    <confidenceEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">0</noiseGain>
      <minimumConfidence description="Minimum confidence level at the given noise level in dB. Defocus valuese whose confidence level is below the minimum threshold is deemed not confident" range="[0,1023]">150</minimumConfidence>
    </confidenceEntries>
    <confidenceEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">1</noiseGain>
      <minimumConfidence description="Minimum confidence level at the given noise level in dB. Defocus valuese whose confidence level is below the minimum threshold is deemed not confident" range="[0,1023]">150</minimumConfidence>
    </confidenceEntries>
    <confidenceEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">12</noiseGain>
      <minimumConfidence description="Minimum confidence level at the given noise level in dB. Defocus valuese whose confidence level is below the minimum threshold is deemed not confident" range="[0,1023]">150</minimumConfidence>
    </confidenceEntries>
    <confidenceEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">24</noiseGain>
      <minimumConfidence description="Minimum confidence level at the given noise level in dB. Defocus valuese whose confidence level is below the minimum threshold is deemed not confident" range="[0,1023]">150</minimumConfidence>
    </confidenceEntries>
    <confidenceEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">31</noiseGain>
      <minimumConfidence description="Minimum confidence level at the given noise level in dB. Defocus valuese whose confidence level is below the minimum threshold is deemed not confident" range="[0,1023]">680</minimumConfidence>
    </confidenceEntries>
    <confidenceEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">35</noiseGain>
      <minimumConfidence description="Minimum confidence level at the given noise level in dB. Defocus valuese whose confidence level is below the minimum threshold is deemed not confident" range="[0,1023]">1100</minimumConfidence>
    </confidenceEntries>
  </confidenceTable>
  <confidenceHighTable>
    <confidenceEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">0</noiseGain>
      <minimumConfidence description="Minimum confidence level at the given noise level in dB. Defocus valuese whose confidence level is below the minimum threshold is deemed not confident" range="[0,1023]">270</minimumConfidence>
    </confidenceEntries>
    <confidenceEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">6</noiseGain>
      <minimumConfidence description="Minimum confidence level at the given noise level in dB. Defocus valuese whose confidence level is below the minimum threshold is deemed not confident" range="[0,1023]">300</minimumConfidence>
    </confidenceEntries>
    <confidenceEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">9.1</noiseGain>
      <minimumConfidence description="Minimum confidence level at the given noise level in dB. Defocus valuese whose confidence level is below the minimum threshold is deemed not confident" range="[0,1023]">350</minimumConfidence>
    </confidenceEntries>
    <confidenceEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">12</noiseGain>
      <minimumConfidence description="Minimum confidence level at the given noise level in dB. Defocus valuese whose confidence level is below the minimum threshold is deemed not confident" range="[0,1023]">400</minimumConfidence>
    </confidenceEntries>
    <confidenceEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">17</noiseGain>
      <minimumConfidence description="Minimum confidence level at the given noise level in dB. Defocus valuese whose confidence level is below the minimum threshold is deemed not confident" range="[0,1023]">400</minimumConfidence>
    </confidenceEntries>
    <confidenceEntries>
      <noiseGain description="Noise level in dB computed as as 20.0 * log10(sensor_gain)" range="[0,40]">23</noiseGain>
      <minimumConfidence description="Minimum confidence level at the given noise level in dB. Defocus valuese whose confidence level is below the minimum threshold is deemed not confident" range="[0,1023]">450</minimumConfidence>
    </confidenceEntries>
  </confidenceHighTable>
  <fallbackConfidence description="Threshold applied to PD confidence level to decide when to perform fallback to other AF algorithm." range="[0,1023]">10</fallbackConfidence>
  <stableTable>
    <stableEntries>
      <FPS description="Frame rate per second" range="[0,120]">10</FPS>
      <minimumStableCount description="Number of frames in which defocus values must remain stable in order for PDAF algorithm to trigger focus convergence" range="[0,30]">0</minimumStableCount>
    </stableEntries>
    <stableEntries>
      <FPS description="Frame rate per second" range="[0,120]">14</FPS>
      <minimumStableCount description="Number of frames in which defocus values must remain stable in order for PDAF algorithm to trigger focus convergence" range="[0,30]">0</minimumStableCount>
    </stableEntries>
    <stableEntries>
      <FPS description="Frame rate per second" range="[0,120]">24</FPS>
      <minimumStableCount description="Number of frames in which defocus values must remain stable in order for PDAF algorithm to trigger focus convergence" range="[0,30]">0</minimumStableCount>
    </stableEntries>
  </stableTable>
  <dofScalerTable>
    <dofScalerEntries>
      <normalizedLensPosition description="Normalized lens position, if lens position is near end, the value is 1, if lens position is far end, the value is 0." range="[0,1]">0</normalizedLensPosition>
      <dofScaler description="DOF scaler value at the given normalized lens position, this scaler will be applied to fine scan step size, defocus threshold, focus done threshold etc./" range="[1,unbounded]">1</dofScaler>
    </dofScalerEntries>
    <dofScalerEntries>
      <normalizedLensPosition description="Normalized lens position, if lens position is near end, the value is 1, if lens position is far end, the value is 0." range="[0,1]">1</normalizedLensPosition>
      <dofScaler description="DOF scaler value at the given normalized lens position, this scaler will be applied to fine scan step size, defocus threshold, focus done threshold etc./" range="[1,unbounded]">2</dofScaler>
    </dofScalerEntries>
  </dofScalerTable>
  <focusScan>
    <focusConvergeFrameSkip description="Number of frame skip to use during PDAF focus convergence" range="[0,5]">1</focusConvergeFrameSkip>
    <enableFineScan description="Enable contrast-based fine scan following PDAF focus convergence" range="[0,1]">1</enableFineScan>
    <minimumFineScanRange description="Minimum fine scan range expressed as scaler multiple to computed fine scan step size." range="[1,2]">1</minimumFineScanRange>
    <fineScanStepSize description="Minimum fine scan step size to use for contrast-based fine scan following PDAF focus converge" range="[1,50]">5</fineScanStepSize>
    <focusDoneThreshold description="Minimum absolute defocus value below which focus converge is deemed to be done" range="[0,50]">15</focusDoneThreshold>
    <enableFineScanExtension description="Enables contrast-based fine scan following PDAF focus convergence to extend search limit as needed to find focus peak" range="[0,1]">0</enableFineScanExtension>
    <firstRunNotConfidenceAdd description="Increases frame count by which PDAF waits for valid defocus statistics to arrive for the first camera turn on" range="[0,5]">0</firstRunNotConfidenceAdd>
  </focusScan>
  <sceneMonitor>
    <waitAfterFocusCount description="Number of frames to wait after focus search finishes before detecting out-of-focus (or defocus) condition" range="[0,10]">20</waitAfterFocusCount>
    <waitConfidenceRecoverCount description="Number of frames to wait for confidence level to recover from a temporary drop (e.g. scene change)" range="[0,10]">8</waitConfidenceRecoverCount>
    <defocusedThreshold description="Minimum size of absolute defocus below which lens is assumed to be in focus" range="[0,50]">25</defocusedThreshold>
    <depthStableThreshold description="Maximum size of frame-to-frame difference in temporally filtered defocus above which defocus is deemed not stable. Focus convergence can only be triggered if defocus is deemed stable" range="[0,50]">20</depthStableThreshold>
    <defocusStableFilterLength description="Size of moving average filter applied to defocus sample" range="[0,5]">3</defocusStableFilterLength>
    <enableTriggerSuppressionBySceneChange description="If enabled, focus trigger is suppressed until scene change is also detected" range="[0,1]">1</enableTriggerSuppressionBySceneChange>
    <defocusDOFMultiplier description="Maximum scaler by which the dept of focus is deemed to increase from hyperfocal distance to 10-cm" range="[0,2]">1.2</defocusDOFMultiplier>
    <defocusThresholdScaler description="Scaler by which defocus threshold is multiplied if scene change is not detected" range="[0,5]">0</defocusThresholdScaler>
  </sceneMonitor>
  <PDPreprocessing>
    <enable description="Enables selective filtering of PD sample based on confidence level and abs(PD)" range="[0,1]">1</enable>
    <enableDoNotUseDefocusSampleByPD description="Enables rejection of PD stat if abs(PD) exceeds this threshold" range="[0,1]">0</enableDoNotUseDefocusSampleByPD>
    <enableIncMinConfidenceThresholdByPD description="Enables increasing of minimimum confidence level if abs(PD) is above certain threshold" range="[0,1]">0</enableIncMinConfidenceThresholdByPD>
    <PDMaxLimitDoNotUseDefocusSample description="Minimum threshold applied to abs(PD) above which the corresponding defocus sample is not used" range="[12,32]">1.8</PDMaxLimitDoNotUseDefocusSample>
    <PDMaxLimitIncMinConfidenceThreshold description="Maximum threshold applied to abs(PD) above which minimum confidence is scaled up" range="[0,5]">1.2</PDMaxLimitIncMinConfidenceThreshold>
    <incMinConfidenceThresholdByPDScaler description="Scaler multiplier by which minimum confidence threshold is increased if abs(PD) is above PDMaxLimitIncMinConfidenceThreshold" range="[0,5]">1.5</incMinConfidenceThresholdByPDScaler>
    <PDStdThreshold description="Maximum threshold for std(PD) above which corresponding defocus sample is not used" range="[0,8]">5</PDStdThreshold>
    <PDDefocusHighErrorScCheck description="If abs(defocus) is above the threshold defined by (PDDefocusHighErrorScCheck * defocus threshold) then focus trigger must also be accompanied by scene change" range="[2,30]">30</PDDefocusHighErrorScCheck>
    <PDAverageDefocusHighErrScCheck description="If temporally filtered abs(defocus) is above the threshold defined by (PDAverageDefocusHighErrScCheck * defocus threshold) focus trigger must also be accompanied by scene change" range="[2,30]">30</PDAverageDefocusHighErrScCheck>
    <PDLowlightGainThresholdScCheck description="If abs(defocus) is below the threshold defined by (PDLowlightGainThresholdScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">20</PDLowlightGainThresholdScCheck>
    <PDDefocusHighScCheck description="If abs(defocus) is below the threshold defined by (PDDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">5</PDDefocusHighScCheck>
    <PDDefocusHighScCheck description="If abs(defocus) is below the threshold defined by (PDDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">5</PDDefocusHighScCheck>
    <PDDefocusHighScCheck description="If abs(defocus) is below the threshold defined by (PDDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">8</PDDefocusHighScCheck>
    <PDDefocusHighScCheck description="If abs(defocus) is below the threshold defined by (PDDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">5</PDDefocusHighScCheck>
    <PDAverageDefocusHighScCheck description="If temporally filtered abs(defocus) is below the threshold defined by (PDAverageDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">5</PDAverageDefocusHighScCheck>
    <PDAverageDefocusHighScCheck description="If temporally filtered abs(defocus) is below the threshold defined by (PDAverageDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">5</PDAverageDefocusHighScCheck>
    <PDAverageDefocusHighScCheck description="If temporally filtered abs(defocus) is below the threshold defined by (PDAverageDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">8</PDAverageDefocusHighScCheck>
    <PDAverageDefocusHighScCheck description="If temporally filtered abs(defocus) is below the threshold defined by (PDAverageDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">5</PDAverageDefocusHighScCheck>
    <PDLowlightDefocusHighScCheck description="If abs(defocus) is below the threshold defined by (PDLowlightDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">4</PDLowlightDefocusHighScCheck>
    <PDLowlightDefocusHighScCheck description="If abs(defocus) is below the threshold defined by (PDLowlightDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">4</PDLowlightDefocusHighScCheck>
    <PDLowlightDefocusHighScCheck description="If abs(defocus) is below the threshold defined by (PDLowlightDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">4</PDLowlightDefocusHighScCheck>
    <PDLowlightDefocusHighScCheck description="If abs(defocus) is below the threshold defined by (PDLowlightDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">4</PDLowlightDefocusHighScCheck>
    <PDLowlightAverageDefocusHighScCheck description="If temporally filtered abs(defocus) is below the threshold defined by (PDLowlightAverageDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">4</PDLowlightAverageDefocusHighScCheck>
    <PDLowlightAverageDefocusHighScCheck description="If temporally filtered abs(defocus) is below the threshold defined by (PDLowlightAverageDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">4</PDLowlightAverageDefocusHighScCheck>
    <PDLowlightAverageDefocusHighScCheck description="If temporally filtered abs(defocus) is below the threshold defined by (PDLowlightAverageDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">4</PDLowlightAverageDefocusHighScCheck>
    <PDLowlightAverageDefocusHighScCheck description="If temporally filtered abs(defocus) is below the threshold defined by (PDLowlightAverageDefocusHighScCheck * defocus threshold) then focus trigger is to be based on scene change" range="[2,30]">4</PDLowlightAverageDefocusHighScCheck>
  </PDPreprocessing>
  <PDInternal>
    <type description="PDAF sensor type used" range="[1,3]">1</type>
    <initialPosition description="Initial lens position when camera turns on" range="[0,500]">10</initialPosition>
    <PDAFEnableFaceCAFPriority description="Flag to enable feature where contrast-based auto focus is invoked if face is detected" range="[0,1]">1</PDAFEnableFaceCAFPriority>
    <incDefocusThresholdPreviousError description="Increase defocus threshold by this parameter in logical lens units if previous iteration of focus converge resulted in error" range="[0,20]">5</incDefocusThresholdPreviousError>
    <fineScanRangeEnhance description="When enabled this feature decreases the estimated fine scan range by 25%" range="[0,1]">0</fineScanRangeEnhance>
    <softRegionThresholdMultiplier description="Description: If defocus value is less than defocus threshold and above soft defocus threshold, then scene change determines if PDAF focus convergence is to be triggered Constraints: Soft threshold defocus is the calculated by defocusThreshold(tuning) multiplied by softRegionThresholdMultiplier. Decreasing this number may cause PDAF to be more sensitive to defocus condition that is accompanied by a scene change." range="[0,1]">0.6</softRegionThresholdMultiplier>
    <enableSoftConfidenceThreshold description="Description: Enables feature which allow the minimum confidence level to slightly decrease during focus convergence due to increased aliasing Constraints: Enable this feature if PDAF frequently transitions to contrast-based AF in the midst of focus convergence. Generally disabled for Type 1 and enabled for Type 2 and 3">0</enableSoftConfidenceThreshold>
    <softConfidenceThresholdDelta description="Description: Represents the decrease in minimum confidence level allowed during focus convergence if enableSoftConfidenceThreshold is enabled Constraints: Increasing this number allows PDAF to employ lower minimum confidence level during focus converge. Setting this number higher than the minimum confidence level causes minimum confidence level requirement to be omitted during focus converge; hence, a care needs to be taken in revising this parameter." range="[0,200]">100</softConfidenceThresholdDelta>
    <softConfidenceFocus_pnt description="Description: Represents the scaler by which PDAF focus convergence slows down for PD samples whose confidence level resides between minimum confidence level and (minimum confidence level - softConfidenceThresholdDelta) Constraints: Decreasing this number causes PDAF to perform focus convergence more slowly for PD samples whose confidence level lies between minimum confidence level and (minimum confidence level - softConfidenceThresholdDelta)" range="[0,1]">0.2</softConfidenceFocus_pnt>
    <enableSoftRegionThresholdHigh description="Description: It is a boolean flag which indicate if softdefocusThresholdHigh will be used as a parameter to trigger focus in soft region when soft region threshold hig(enableSoftRegionThresholdHigh) is enabled.">1</enableSoftRegionThresholdHigh>
    <softRegionThresholdHighMultiplier description="Description: Defocus multiplier to make defocus threshold higher. Please refer to enableSoftRegionThresholdHigh image." range="[2,6]">4</softRegionThresholdHighMultiplier>
    <softSceneChangeCount description="Description: number of scene changed reported by AF continues." range="[1,6]">1</softSceneChangeCount>
    <cafStableFrameAllow>
      <enable>1</enable>
      <frameCount>15</frameCount>
    </cafStableFrameAllow>
  </PDInternal>
  <PDMultiWindow>
    <enable description="Enables multi-window auto focus">0</enable>
    <HClipRatioNormalLight description="Normalized x coordinate of top-left corner of multi-window ROI under modest to bright light conditions. (x,y) = (0,0) means top-left corner of full field of view." range="[0,1]">0.3</HClipRatioNormalLight>
    <VClipRatioNormalLight description="Normalized y coordinate of top-left corner of multi-window ROI under modest to bright light conditions. (x,y) = (0,0) means top-left corner of full field of view." range="[0,1]">0.3</VClipRatioNormalLight>
    <HClipRatioLowLight description="Normalized x coordinate of top-left corner of multi-window ROI under low light conditions. (x,y) = (0,0) means top-left corner of full field of view." range="[0,1]">0.3</HClipRatioLowLight>
    <VClipRatioLowLight description="Normalized y coordinate of top-left corner of multi-window ROI under low light conditions. (x,y) = (0,0) means top-left corner of full field of view." range="[0,1]">0.3</VClipRatioLowLight>
    <HNumWindows description="Horizontal grid size of multi-window ROI." range="[1,5]">5</HNumWindows>
    <VNumWindows description="Vertical grid size of multi-window ROI." range="[1,5]">5</VNumWindows>
    <PDPercentile description="Pd_percentile Description: Nth Percentile of the valid windows to select from." range="[0,1]">0.2</PDPercentile>
    <defocusThreshold description="Windows within this threshold of the best window will be selected for contrast AF to calcuate FV." range="[0,50]">10</defocusThreshold>
    <confidenceThMultiple description="the confidence threshold for mw grids will be the min-conf * ConfidenceThMultiple." range="[0,10]">1.5</confidenceThMultiple>
    <multiDepthDetect>
      <percentile description="after sorting, will use this percentile to get the detect size for multi-depth detection." range="[0,1]">0.08</percentile>
      <detectThLow description="depth difference from multi-depth detection lower than this threshold when in muti-depth mode ,transition to not muti-depth condition." range="[0,500]">100</detectThLow>
      <detectThHigh description="depth difference from multi-depth detection higher than this threshold when in not multi-depth mode , transition to multi-depth condition." range="[0,500]">150</detectThHigh>
    </multiDepthDetect>
    <lowLightDetect>
      <gainThLow description="aec gain lower than this threshold when in lowlight mode , transition to normal light MW condition." range="[0,60]">10</gainThLow>
      <gainThHigh description="aec gain higher than this threshold when in normal light mode , transition to low light MW condition." range="[0,60]">12</gainThHigh>
    </lowLightDetect>
    <lockToPeripheralDuringSearch description="flag whether to lock the roi to Peripheral during search on the Peripheral">0</lockToPeripheralDuringSearch>
    <activZoomControl>
      <enable description="Multi-window PDAF will only enable if zoom level is less than mw_active_zoom_threshold.If zoom level is higher than this threshold, then PDAF will be configured to 1x1 ROI instead to ensure enough pixels located inside. This is flag to enable/disable the mechanism. If this is disabled, then all zoom level will run multi-window PDAF, which may have hunting effect at high zoom level.">0</enable>
      <zoomThreshold description="Multi-window PDAF will only enable if zoom level is less than this threshold.If zoom level level higher than this threshold, then PDAF will be configured to 1x1 to ensure enough pixels is located inside.">0.4</zoomThreshold>
    </activZoomControl>
  </PDMultiWindow>
  <enableCheckVHStatsRatio description="Sony confirms that type 1 lib will generate inaccurate PD value with high confidence in scene of 5-30 degree stripe line. We use this flag to enable a function which will detect this scene by ratio of H, V focus value and set PDAF 'isConfidence' false when this scene is detected." range="[0,1]">0</enableCheckVHStatsRatio>
  <VHStatsRatioUnconfidentThreshold description="Sony confirms that type 1 lib will generate inaccurate PD value with high confidence in scene of 5-30 degree stripe line. We set PD 'isConfidence' false if ratio H, V focus value is larger than this threshold." range="[0,20]">4</VHStatsRatioUnconfidentThreshold>
  <enablePDEarlyInterrupt description="If early interrupt is supported and PDLib is handled in sensor side, this flag should be true, otherwise stays false. Important dependency, please pay attention. PD_early_interrupt_enabled = 1 then focus_conv_frame_skip = 0 PD_early_interrupt_enabled = 0 then focus_conv_frame_skip = 1 For PD early interrupt to work, BAF ROI should be the same as PDAF ROI.  PDAF ROI will be set in imx362_pdaf.h. Look for (pdaf_address_end_hori, etc) In tuning header h_clip_ratio_normal_light = pdaf_address_end_hori - pdaf_address_start_hori. The same for vertical." range="[0,1]">1</enablePDEarlyInterrupt>
  <dynamicFrameSkipVBlankThreshold description="We don't have to do frame skip for PDAF when VBlank time is larger this threshold" range="[0.0, 30.0]">30.0</dynamicFrameSkipVBlankThreshold>
  <ledPdafMaxFrameAllow>
    <enable description="LED PDAF convergence max frame control enable flag. When this flag is enabled, it will read LED_PDAF_max_frame_cnt and force LED PDAF to complete converge when converge frame is more than the max allowed. This prevents power drain and app timeout in case of constantscene panning." range="[0,1]">0</enable>
    <maxFrameCnt description="PDAF stats is forced to enter focus converge done when LED pd converge is over this threshold" range="[1,200]">50</maxFrameCnt>
  </ledPdafMaxFrameAllow>
  <sparsePDTouchFaceConfidenceThreshold description="Confidence threshold required to determine if to fallback or run PDAF while touch/face." range="[0,1023]">400</sparsePDTouchFaceConfidenceThreshold>
  <sparsePDTouchFaceLowDefocusConfidenceThreshold description="Confidence threshold required to determine if to fallback or fine scan while touch/face." range="[0,1023]">500</sparsePDTouchFaceLowDefocusConfidenceThreshold>
  <enableEnterLSPLowConfidenceHunting description="PD variation is large in some test scene and cause hunting issue. Force this test scene enter to LSP when sign of PD is reverted in some times. LSP will use contrast information to find final position." range="[0,1]">1</enableEnterLSPLowConfidenceHunting>
  <LSPLowConfidenceHuntingThreshold description="PDAF stats is forced to enter focus converge done when sign of PD reverted counter is over this threshold." range="[0,10]">2</LSPLowConfidenceHuntingThreshold>
  <face>
    <faceROIProcess>
      <ROIProcessEnable>1</ROIProcessEnable>
      <ROIRoughStable>
        <statsROIDiffEnable>1</statsROIDiffEnable>
        <TriggerCtrlType>TriggerCtrlGain</TriggerCtrlType>
        <statsROIDiffThreshold description="statsROIStableDiff for location, size and count" tuning_parameter_level="rarely_tune">
          <triggerPt>
            <start range="[-100.0,15000.0]">0</start>
            <end range="[-100.0,15000.0]">0</end>
          </triggerPt>
          <triggerData>
            <triggerPt>
              <start range="[-100.0,15000.0]">8</start>
              <end range="[-100.0,15000.0]">8</end>
            </triggerPt>
            <triggerData>
              <locationThreshold description="the center of face roi change threshold" range="[0.0,100.0]">2</locationThreshold>
              <sizeThreshold description="the size of face roi change threshold" range="[0.0,100.0]">2</sizeThreshold>
              <countThreshold description="If the face roi stable keep n frame, and n bigger than this threshold, and this face roi will be set to be stable" range="[0,100]">3</countThreshold>
            </triggerData>
          </triggerData>
          <triggerData>
            <triggerPt>
              <start range="[-100.0,15000.0]">4</start>
              <end range="[-100.0,15000.0]">4</end>
            </triggerPt>
            <triggerData>
              <locationThreshold description="the center of face roi change threshold" range="[0.0,100.0]">2</locationThreshold>
              <sizeThreshold description="the size of face roi change threshold" range="[0.0,100.0]">2</sizeThreshold>
              <countThreshold description="If the face roi stable keep n frame, and n bigger than this threshold, and this face roi will be set to be stable" range="[0,100]">3</countThreshold>
            </triggerData>
          </triggerData>
          <triggerData>
            <triggerPt>
              <start range="[-100.0,15000.0]">1</start>
              <end range="[-100.0,15000.0]">1</end>
            </triggerPt>
            <triggerData>
              <locationThreshold description="the center of face roi change threshold" range="[0.0,100.0]">2</locationThreshold>
              <sizeThreshold description="the size of face roi change threshold" range="[0.0,100.0]">2</sizeThreshold>
              <countThreshold description="If the face roi stable keep n frame, and n bigger than this threshold, and this face roi will be set to be stable" range="[0,100]">3</countThreshold>
            </triggerData>
          </triggerData>
        </statsROIDiffThreshold>
      </ROIRoughStable>
      <ROIStrictStable>
        <statsROIDiffEnable>1</statsROIDiffEnable>
        <TriggerCtrlType>TriggerCtrlGain</TriggerCtrlType>
        <statsROIDiffThreshold description="statsROIStableDiff for location, size and count" tuning_parameter_level="rarely_tune">
          <triggerPt>
            <start range="[-100.0,15000.0]">0</start>
            <end range="[-100.0,15000.0]">0</end>
          </triggerPt>
          <triggerData>
            <triggerPt>
              <start range="[-100.0,15000.0]">8</start>
              <end range="[-100.0,15000.0]">8</end>
            </triggerPt>
            <triggerData>
              <locationThreshold description="the center of face roi change threshold" range="[0.0,100.0]">0.5</locationThreshold>
              <sizeThreshold description="the size of face roi change threshold" range="[0.0,100.0]">0.5</sizeThreshold>
              <countThreshold description="If the face roi stable keep n frame, and n bigger than this threshold, and this face roi will be set to be stable" range="[0,100]">3</countThreshold>
            </triggerData>
          </triggerData>
          <triggerData>
            <triggerPt>
              <start range="[-100.0,15000.0]">4</start>
              <end range="[-100.0,15000.0]">4</end>
            </triggerPt>
            <triggerData>
              <locationThreshold description="the center of face roi change threshold" range="[0.0,100.0]">0.5</locationThreshold>
              <sizeThreshold description="the size of face roi change threshold" range="[0.0,100.0]">0.5</sizeThreshold>
              <countThreshold description="If the face roi stable keep n frame, and n bigger than this threshold, and this face roi will be set to be stable" range="[0,100]">3</countThreshold>
            </triggerData>
          </triggerData>
          <triggerData>
            <triggerPt>
              <start range="[-100.0,15000.0]">1</start>
              <end range="[-100.0,15000.0]">1</end>
            </triggerPt>
            <triggerData>
              <locationThreshold description="the center of face roi change threshold" range="[0.0,100.0]">0.5</locationThreshold>
              <sizeThreshold description="the size of face roi change threshold" range="[0.0,100.0]">0.5</sizeThreshold>
              <countThreshold description="If the face roi stable keep n frame, and n bigger than this threshold, and this face roi will be set to be stable" range="[0,100]">3</countThreshold>
            </triggerData>
          </triggerData>
        </statsROIDiffThreshold>
      </ROIStrictStable>
    </faceROIProcess>
    <minMoveThreshold description="While running face tracking for 2PD, if defocus is less than this threshold then focus search will not be re-triggered" range="[0,7]">3</minMoveThreshold>
    <ROIMoveConvergeSuppress>
      <enable description="Enable flag for face 2pd ROI move converge suppress">false</enable>
      <stableCountThreshold description="Stable counter threshold for face 2PD roi move converge suppress.Once face ROI is less than moving threshold for continuous frames over the counter PDAF will resume converging" range="[1,100]">3</stableCountThreshold>
      <moveThresholdInX description="Face tracking 2PD, if ROI is moving over defined X threshold, then converge suppress will occur" range="[0.1,1.0]">0.5</moveThresholdInX>
      <moveThresholdInY description="Face tracking 2PD, if ROI is moving over defined Y threshold, then converge suppress will occur" range="[0.1,1.0]">0.5</moveThresholdInY>
    </ROIMoveConvergeSuppress>
    <defocusFilter>
      <enable description="Face tracking 2PD, temporal filter to calculate average target position and use target positon to calculate average defocus and next position">true</enable>
      <length description="Face tracking 2PD, length of moving average filter applied to target lens position" range="[1,10]">3</length>
      <confidenceHighThreshold description="Face tracking 2PD, if confidence is above this threshold then lens is moved to 100% of defocus. If confidence is lower than min_conf the lens is not moved. If confidence is between this threshold and min_conf then the lens is moved by interpolated percentage" range="[0,1023]">700</confidenceHighThreshold>
    </defocusFilter>
    <fallback>
      <enable description="Face tracking 2PD is always in converge state. This flag is used to enable fallback in some specification condition. If face fallback condition is met and this flag is enable then fallback to contrast-based AF is invoked">false</enable>
      <fallbackROISizeThreshold description="Face tracking 2PD, enter fallback status if one of ROI dimension is small than this threshold" range="[0,4032]">200</fallbackROISizeThreshold>
    </fallback>
    <faceChangeRefocusTrigger>
      <enable description="Enable face PDAF face change refocus trigger. When face change criteria is satisfied then scene change flag will be raised and PDAF refocus will be triggered.">false</enable>
      <roiChangeThreshPercentage description="When face ROI vs. reference ROI has moved more than thresh percentage, face refocus will trigger. Percentage is calculated by face ROI move delta divide by CAMIF width or height." range="[0,1]">0.1</roiChangeThreshPercentage>
      <roiSizeStableThresh description="When current face ROI vs. last frame face ROI moves less than this pixel threshold, we report face regains stability. This is not a percentage." range="[0,100]">10</roiSizeStableThresh>
    </faceChangeRefocusTrigger>
  </face>
  <touch>
    <offCenterThreshold description="Radius distance from touch ROI to center ROI in terms of dist divided by CAMIF radius. This value is a percentage of camif radius. Image center PD perforamnce is better than corner. When defocus is large enough, corner image PD may not accurate enough and hit over-shoot situation. This threshold to divide FOV to two zone: center/corner. If corner zone defocus is large lens is moved incrementally" range="[0,1]">0.33</offCenterThreshold>
    <skipSearchIfSceneInFocus description="flag to enable PDAF skip refocus if scene is already in focus." range="[0,1]">0</skipSearchIfSceneInFocus>
  </touch>
  <track>
    <trackROIProcess>
      <trackROIRoughStable>
        <statsROIDiffEnable>1</statsROIDiffEnable>
        <TriggerCtrlType>TriggerCtrlGain</TriggerCtrlType>
        <statsROIDiffThreshold description="statsROIStableDiff for location, size and count" tuning_parameter_level="rarely_tune">
          <triggerPt>
            <start range="[-100.0,15000.0]">0</start>
            <end range="[-100.0,15000.0]">0</end>
          </triggerPt>
          <triggerData>
            <triggerPt>
              <start range="[-100.0,15000.0]">8</start>
              <end range="[-100.0,15000.0]">8</end>
            </triggerPt>
            <triggerData>
              <locationThreshold description="the center of track roi change threshold" range="[0.0,100.0]">2</locationThreshold>
              <sizeThreshold description="the size of track roi change threshold" range="[0.0,100.0]">2</sizeThreshold>
              <countThreshold description="If the track roi stable keep n frame, and n bigger than this threshold, and this track  roi will be set to be stable" range="[0,100]">3</countThreshold>
            </triggerData>
          </triggerData>
          <triggerData>
            <triggerPt>
              <start range="[-100.0,15000.0]">4</start>
              <end range="[-100.0,15000.0]">4</end>
            </triggerPt>
            <triggerData>
              <locationThreshold description="the center of track roi change threshold" range="[0.0,100.0]">2</locationThreshold>
              <sizeThreshold description="the size of track roi change threshold" range="[0.0,100.0]">2</sizeThreshold>
              <countThreshold description="If the track roi stable keep n frame, and n bigger than this threshold, and this track roi will be set to be stable" range="[0,100]">3</countThreshold>
            </triggerData>
          </triggerData>
          <triggerData>
            <triggerPt>
              <start range="[-100.0,15000.0]">1</start>
              <end range="[-100.0,15000.0]">1</end>
            </triggerPt>
            <triggerData>
              <locationThreshold description="the center of track roi change threshold" range="[0.0,100.0]">2</locationThreshold>
              <sizeThreshold description="the size of track roi change threshold" range="[0.0,100.0]">2</sizeThreshold>
              <countThreshold description="If the track  roi stable keep n frame, and n bigger than this threshold, and this track roi will be set to be stable" range="[0,100]">3</countThreshold>
            </triggerData>
          </triggerData>
        </statsROIDiffThreshold>
      </trackROIRoughStable>
      <trackROIStrictStable>
        <statsROIDiffEnable>1</statsROIDiffEnable>
        <TriggerCtrlType>TriggerCtrlGain</TriggerCtrlType>
        <statsROIDiffThreshold description="statsROIStableDiff for location, size and count" tuning_parameter_level="rarely_tune">
          <triggerPt>
            <start range="[-100.0,15000.0]">0</start>
            <end range="[-100.0,15000.0]">0</end>
          </triggerPt>
          <triggerData>
            <triggerPt>
              <start range="[-100.0,15000.0]">8</start>
              <end range="[-100.0,15000.0]">8</end>
            </triggerPt>
            <triggerData>
              <locationThreshold description="the center of track roi change threshold" range="[0.0,100.0]">0.5</locationThreshold>
              <sizeThreshold description="the size of track roi change threshold" range="[0.0,100.0]">0.5</sizeThreshold>
              <countThreshold description="If the track roi stable keep n frame, and n bigger than this threshold, and this track roi will be set to be stable" range="[0,100]">3</countThreshold>
            </triggerData>
          </triggerData>
          <triggerData>
            <triggerPt>
              <start range="[-100.0,15000.0]">4</start>
              <end range="[-100.0,15000.0]">4</end>
            </triggerPt>
            <triggerData>
              <locationThreshold description="the center of track roi change threshold" range="[0.0,100.0]">0.5</locationThreshold>
              <sizeThreshold description="the size of track roi change threshold" range="[0.0,100.0]">0.5</sizeThreshold>
              <countThreshold description="If the track roi stable keep n frame, and n bigger than this threshold, and this track roi will be set to be stable" range="[0,100]">3</countThreshold>
            </triggerData>
          </triggerData>
          <triggerData>
            <triggerPt>
              <start range="[-100.0,15000.0]">1</start>
              <end range="[-100.0,15000.0]">1</end>
            </triggerPt>
            <triggerData>
              <locationThreshold description="the center of track roi change threshold" range="[0.0,100.0]">0.5</locationThreshold>
              <sizeThreshold description="the size of track roi change threshold" range="[0.0,100.0]">0.5</sizeThreshold>
              <countThreshold description="If the track roi stable keep n frame, and n bigger than this threshold, and this track roi will be set to be stable" range="[0,100]">3</countThreshold>
            </triggerData>
          </triggerData>
        </statsROIDiffThreshold>
      </trackROIStrictStable>
    </trackROIProcess>
    <minMoveThreshold description="While running track tracking for 2PD, if defocus is less than this threshold then focus search will not be re-triggered" range="[0,7]">3</minMoveThreshold>
    <defocusFilter>
      <enable description="track tracking 2PD, temporal filter to calculate average target position and use target positon to calculate average defocus and next position">true</enable>
      <length description="track tracking 2PD, length of moving average filter applied to target lens position" range="[1,10]">3</length>
      <confidenceHighThreshold description="track tracking 2PD, if confidence is above this threshold then lens is moved to 100% of defocus. If confidence is lower than min_conf the lens is not moved. If confidence is between this threshold and min_conf then the lens is moved by interpolated percentage" range="[0,1023]">700</confidenceHighThreshold>
    </defocusFilter>
    <fallback>
      <enable description="track tracking 2PD is always in converge state. This flag is used to enable fallback in some specification condition. If track fallback condition is met and this flag is enable then fallback to contrast-based AF is invoked">false</enable>
      <fallbackROISizeThreshold description="track tracking 2PD, enter fallback status if one of ROI dimension is small than this threshold" range="[0,4032]">200</fallbackROISizeThreshold>
    </fallback>
  </track>
  <convergeDoneFilter>
    <enable description="Flag to enable temproal filter applied to target lens position during focus converge">false</enable>
    <length description="Length of moving average filter applied to target lens position during focus converge" range="[1,5]">3</length>
    <threshold description="Threshold used to assess focus done condition. If the difference between target lens position and the next lens position is less then this threshold then focus convergence is done" range="[1,900]">5</threshold>
  </convergeDoneFilter>
  <forceEnterFineSearch>
    <enable description="Force enabling or disabling of contrast-based fine scan">false</enable>
    <directionReverseCountThreshold description="TODO_DESCRIPTION" range="[0,10]">2</directionReverseCountThreshold>
  </forceEnterFineSearch>
  <advancedSparseControl>
    <enableForSparsePD>false</enableForSparsePD>
    <skipFineScan>1</skipFineScan>
    <focusDoneThreshold>10</focusDoneThreshold>
    <focusTable>
      <focusEntries>
        <defocus description="Defocus in logical lens position unit" range="[0,500]">16</defocus>
        <movePercent description="Percentage lens movement to target lens position" range="[0,1]">1.0</movePercent>
      </focusEntries>
      <focusEntries>
        <defocus description="Defocus in logical lens position unit" range="[0,500]">32</defocus>
        <movePercent description="Percentage lens movement to target lens position" range="[0,1]">0.95</movePercent>
      </focusEntries>
      <focusEntries>
        <defocus description="Defocus in logical lens position unit" range="[0,500]">64</defocus>
        <movePercent description="Percentage lens movement to target lens position" range="[0,1]">0.9</movePercent>
      </focusEntries>
      <focusEntries>
        <defocus description="Defocus in logical lens position unit" range="[0,500]">128</defocus>
        <movePercent description="Percentage lens movement to target lens position" range="[0,1]">0.85</movePercent>
      </focusEntries>
      <focusEntries>
        <defocus description="Defocus in logical lens position unit" range="[0,500]">256</defocus>
        <movePercent description="Percentage lens movement to target lens position" range="[0,1]">0.7</movePercent>
      </focusEntries>
      <focusEntries>
        <defocus description="Defocus in logical lens position unit" range="[0,500]">399</defocus>
        <movePercent description="Percentage lens movement to target lens position" range="[0,1]">0.6</movePercent>
      </focusEntries>
    </focusTable>
  </advancedSparseControl>
</chromatixPDAF>
